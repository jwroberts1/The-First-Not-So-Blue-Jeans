<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Story of the Frisbee Practice Test</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .correct {
            background-color: #dcfce7;
            border-left: 4px solid #10b981;
        }

        .incorrect {
            background-color: #fee2e2;
            border-left: 4px solid #ef4444;
        }

        .question-option {
            transition: all 0.2s;
            cursor: pointer;
        }

        .question-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .question-option.selected {
            background-color: #e0f2fe;
            border-left: 4px solid #3b82f6;
        }

        .question-option.correct-answer {
            background-color: #dcfce7;
            border-left: 4px solid #10b981;
        }

        .question-option.incorrect-answer {
            background-color: #fee2e2;
            border-left: 4px solid #ef4444;
        }

        /* Custom styles for the game */
        #game-canvas {
            background-color: #000;
            border: 2px solid #0ff;
            box-shadow: 0 0 20px #0ff;
        }
    </style>
</head>

<body class="p-4 sm:p-8">
    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-lg p-6 sm:p-10 mb-8">
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-gray-800 mb-6">The Story of the Frisbee</h1>
        <p class="text-gray-600 text-center mb-8">Read the passage. Then answer the questions.</p>

        <!-- Quiz Section -->
        <div id="quiz-container">
            <div id="passage" class="bg-gray-50 rounded-lg p-6 mb-10 text-gray-700 leading-relaxed text-sm sm:text-base border border-gray-200">
                <h2 class="text-xl sm:text-2xl font-semibold mb-4">Passage:</h2>
                <p class="mb-4">The story of the Frisbee begins not with a plastic disc, but with a simple pie tin. In the late 1800s, a man named William Russell Frisbie started a bakery in Bridgeport, Connecticut. His business, the Frisbie Pie Company, quickly became famous for its delicious pies. University students from nearby Yale and other schools were some of his best customers. After they finished eating the pies, they would often take the empty tin plates and toss them around for a game of catch. The light, round shape of the tins made them perfect for gliding through the air. As a fun warning, they would yell out "Frisbie!" to anyone in the way. This playful tradition became a part of campus life and was the very humble beginning of a worldwide phenomenon.</p>
                <p class="mb-4">Years later, in the late 1940s, a man named Walter "Fred" Morrison saw people tossing around a popcorn tin lid on a California beach. He had an idea to create a better, more perfect flying disc. He and his partner, Warren Franscioni, designed a plastic version they called the "Flyin' Saucer." This was an exciting time when people were fascinated by stories of unidentified flying objects (UFOs) and flying saucers. The toy was made of a brittle plastic that would often crack and break when it hit something hard. They sold their invention at county fairs, but people wanted something more durable. The "Flyin' Saucer" was a novel idea but had some obvious flaws.</p>
                <p class="mb-4">Morrison continued to work on his design, making the disc thicker and more flexible. In 1957, he sold his updated model to the Wham-O toy company. Wham-O was a small but clever company known for making fun toys like the Hula Hoop. Richard Knerr, one of the founders of Wham-O, loved the flying disc but disliked the name. He had heard about the students who used to throw the pie tins and decided to call the toy the **Frisbee**. This new name, which honored the old pie tins, was a huge success.</p>
                <p class="mb-4">Wham-O's team, led by inventor Ed Headrick, was tasked with making the Frisbee fly even better. He studied the way it moved through the air and came up with a simple but brilliant idea. He added a series of rings to the top of the disc. These rings, which came to be known as the "Headrick Rings," were a key innovation that improved the disc's aerodynamics. They allowed the disc to fly with remarkable stability and accuracy. Thanks to these improvements, the Frisbee became a popular outdoor pastime for millions of people worldwide, and it even led to the creation of competitive sports like Ultimate Frisbee. Today, people still enjoy this fun pastime in parks, on beaches, and in their own backyards.</p>
            </div>

            <div id="questions-container" class="space-y-10">
                <!-- Questions will be dynamically inserted here by JavaScript -->
            </div>
            
            <div class="mt-10 text-center space-x-4">
                <button id="submitBtn" class="bg-blue-500 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-600 transition duration-300">
                    Check Answers
                </button>
            </div>
        </div>
        
        <div id="results" class="mt-8 p-6 rounded-lg text-center font-bold text-lg hidden">
            <p id="scoreText"></p>
            <div class="mt-4 space-x-4">
                <button id="startGameBtn" class="bg-green-500 text-white font-bold py-3 px-8 rounded-full hover:bg-green-600 transition duration-300 hidden">
                    Congratulations! Check out your reward
                </button>
                <button id="retakeQuizBtn" class="bg-gray-300 text-gray-800 font-bold py-3 px-8 rounded-full hover:bg-gray-400 transition duration-300 hidden">
                    Retake Quiz
                </button>
            </div>
        </div>

        <hr class="my-12 border-gray-300">

        <!-- Game Section -->
        <div id="game-container" class="mt-8 text-center" style="display: none;">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Frisbee Catch Game</h2>
            <div class="flex flex-col items-center justify-center">
                <canvas id="game-canvas" width="600" height="400" class="rounded-lg shadow-2xl"></canvas>
                <div id="countdown-overlay" class="absolute inset-0 flex items-center justify-center text-white text-9xl font-bold bg-black bg-opacity-75 z-10 hidden"></div>
                <div class="mt-4 text-gray-800 font-semibold text-lg flex justify-between w-full max-w-sm">
                    <span>Time: <span id="time-display">0.00</span>s</span>
                    <span>Catches: <span id="catches-display">0</span></span>
                </div>
                <div id="game-over-message" class="mt-4 text-red-500 font-bold text-2xl hidden">
                    GAME OVER!
                </div>
                <button id="restart-game-btn" class="mt-4 bg-gray-300 text-gray-800 font-bold py-3 px-8 rounded-full hover:bg-gray-400 transition duration-300 hidden">
                    Play Again
                </button>
            </div>
        </div>
    </div>

    <script>
        // Array of all quiz questions
        const allQuestions = [
            {
                id: 'q1',
                questionText: 'How is the information in the passage organized?',
                options: [
                    { value: 'A', text: 'by showing the sequence of events that led to the invention of the Frisbee' },
                    { value: 'B', text: 'by telling the effects of different types of plastic used to make the disc' },
                    { value: 'C', text: 'by explaining how each new idea created a new problem for the inventors' },
                    { value: 'D', text: 'by mentioning other toys that were also popular at the time' }
                ],
                type: 'radio'
            },
            {
                id: 'q2',
                questionText: 'What happened before Walter Morrison sold his design to Wham-O?',
                options: [
                    { value: 'A', text: 'The disc was renamed "The Frisbee."' },
                    { value: 'B', text: 'The company added rings to the top for stability.' },
                    { value: 'C', text: 'Students began throwing pie tins for fun.' },
                    { value: 'D', text: 'He sold the "Flyin\' Saucer" at county fairs.' }
                ],
                type: 'radio'
            },
            {
                id: 'q3',
                questionText: 'What was the effect of Ed Headrick adding rings to the disc?',
                options: [
                    { value: 'A', text: 'The disc became more expensive to produce.' },
                    { value: 'B', text: 'The disc was renamed the "Frisbee."' },
                    { value: 'C', text: 'It helped the disc fly with remarkable accuracy.' },
                    { value: 'D', text: 'Wham-O sold the rights to the design.' }
                ],
                type: 'radio'
            },
            {
                id: 'q4',
                questionText: 'Read the sentence from the passage. "This was the humble beginning of a worldwide phenomenon." Which word from the sentence is a compound word?',
                options: [
                    { value: 'A', text: 'humble' },
                    { value: 'B', text: 'beginning' },
                    { value: 'C', text: 'worldwide' },
                    { value: 'D', text: 'phenomenon' }
                ],
                type: 'radio'
            },
            {
                id: 'q5',
                questionText: 'Read the sentence from the passage. "He had heard about the college students\' fun and decided to rename the toy after the pie tins." What does the compound word rename mean?',
                options: [
                    { value: 'A', text: 'to name again' },
                    { value: 'B', text: 'to name for the first time' },
                    { value: 'C', text: 'to not have a name' },
                    { value: 'D', text: 'to name in a different language' }
                ],
                type: 'radio'
            },
            {
                id: 'q6',
                questionText: 'Select the words from the passage that are compound words.',
                options: [
                    { value: 'backyard', text: 'backyard' },
                    { value: 'outdoor', text: 'outdoor' },
                    { value: 'something', text: 'something' },
                    { value: 'pastime', text: 'pastime' },
                    { value: 'another', text: 'another' },
                    { value: 'company', text: 'company' },
                    { value: 'brittle', text: 'brittle' }
                ],
                type: 'checkbox'
            }
        ];

        // Correct answers stored separately
        const correctAnswers = {
            q1: "A",
            q2: "D",
            q3: "C",
            q4: "C",
            q5: "A",
            q6: ["backyard", "outdoor", "something", "pastime"]
        };

        const submitBtn = document.getElementById('submitBtn');
        const retakeQuizBtn = document.getElementById('retakeQuizBtn');
        const startGameBtn = document.getElementById('startGameBtn');
        const resultsDiv = document.getElementById('results');
        const scoreText = document.getElementById('scoreText');
        const questionsContainer = document.getElementById('questions-container');

        // Game-related elements
        const quizContainer = document.getElementById('quiz-container');
        const gameContainer = document.getElementById('game-container');
        const countdownOverlay = document.getElementById('countdown-overlay');


        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderQuiz() {
            // Clear existing questions
            questionsContainer.innerHTML = '';
            resultsDiv.classList.add('hidden');
            gameContainer.style.display = 'none';
            startGameBtn.classList.add('hidden');
            retakeQuizBtn.classList.add('hidden');
            quizContainer.style.display = 'block';
            
            // Define the labels for the options
            const optionLabels = ['A', 'B', 'C', 'D', 'E', 'F', 'G'];

            // Shuffle questions and render
            const shuffledQuestions = shuffleArray([...allQuestions]);
            let questionNumber = 1;
            shuffledQuestions.forEach(q => {
                const questionDiv = document.createElement('div');
                questionDiv.id = q.id;
                questionDiv.className = 'question p-6 rounded-lg shadow-md bg-white border border-gray-200';
                
                let optionsHtml = '';
                const shuffledOptions = shuffleArray([...q.options]);
                shuffledOptions.forEach((option, index) => {
                    const label = optionLabels[index];
                    optionsHtml += `
                        <label class="question-option block bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <input type="${q.type}" name="${q.id}" value="${option.value}" class="mr-3">
                            ${label}. ${option.text}
                        </label>
                    `;
                });

                questionDiv.innerHTML = `
                    <p class="font-semibold text-lg mb-4">${questionNumber}. ${q.questionText}</p>
                    <div class="space-y-4 text-sm sm:text-base">
                        ${optionsHtml}
                    </div>
                `;
                questionsContainer.appendChild(questionDiv);
                questionNumber++;
            });

            // Re-attach event listeners for styling
            document.querySelectorAll('.question-option').forEach(label => {
                label.addEventListener('click', () => {
                    const input = label.querySelector('input');
                    if (input.type === 'radio') {
                        document.querySelectorAll(`input[name="${input.name}"]`).forEach(radio => {
                            radio.parentElement.classList.remove('selected');
                        });
                        label.classList.add('selected');
                    } else if (input.type === 'checkbox') {
                        label.classList.toggle('selected');
                    }
                });
            });
        }

        submitBtn.addEventListener('click', () => {
            let score = 0;
            let totalQuestions = 0;

            // Clear previous feedback
            document.querySelectorAll('.question-option').forEach(label => {
                label.classList.remove('selected', 'correct-answer', 'incorrect-answer');
            });

            // Check each question
            questionsContainer.querySelectorAll('.question').forEach(question => {
                const questionId = question.id;
                const labels = question.querySelectorAll('.question-option');
                const radios = question.querySelectorAll('input[type="radio"]');
                const checkboxes = question.querySelectorAll('input[type="checkbox"]');
                
                if (radios.length > 0) {
                    totalQuestions++;
                    const selected = question.querySelector('input[type="radio"]:checked');
                    const correctAnswerValue = correctAnswers[questionId];

                    labels.forEach(label => {
                        const input = label.querySelector('input');
                        if (input.value === correctAnswerValue) {
                            label.classList.add('correct-answer');
                        }
                    });

                    if (selected && selected.value === correctAnswerValue) {
                        score++;
                    } else if (selected) {
                        selected.parentElement.classList.add('incorrect-answer');
                    }
                } else if (checkboxes.length > 0) {
                    totalQuestions++;
                    const selectedCheckboxes = Array.from(checkboxes).filter(cb => cb.checked).map(cb => cb.value);
                    const correctCheckboxAnswers = correctAnswers[questionId];

                    labels.forEach(label => {
                        const input = label.querySelector('input');
                        if (correctCheckboxAnswers.includes(input.value)) {
                            label.classList.add('correct-answer');
                        }
                        if (selectedCheckboxes.includes(input.value) && !correctCheckboxAnswers.includes(input.value)) {
                            label.classList.add('incorrect-answer');
                        }
                    });
                    
                    const allCorrectSelected = correctCheckboxAnswers.every(val => selectedCheckboxes.includes(val));
                    const noIncorrectSelected = selectedCheckboxes.every(val => correctCheckboxAnswers.includes(val));
                    
                    if (allCorrectSelected && noIncorrectSelected) {
                        score++;
                    }
                }
            });

            const percentage = (score / totalQuestions) * 100;
            scoreText.textContent = `You scored ${score} out of ${totalQuestions} (${percentage.toFixed(0)}%).`;
            resultsDiv.classList.remove('hidden');

            if (score === totalQuestions) {
                resultsDiv.classList.add('bg-green-100', 'text-green-700');
                resultsDiv.classList.remove('bg-red-100', 'text-red-700');
                startGameBtn.classList.remove('hidden');
            } else {
                resultsDiv.classList.add('bg-red-100', 'text-red-700');
                resultsDiv.classList.remove('bg-green-100', 'text-green-700');
            }
            retakeQuizBtn.classList.remove('hidden');
        });

        retakeQuizBtn.addEventListener('click', () => {
            renderQuiz();
        });

        startGameBtn.addEventListener('click', () => {
            quizContainer.style.display = 'none';
            gameContainer.style.display = 'block';
            startCountdown();
        });
        
        function startCountdown() {
            let count = 3;
            countdownOverlay.textContent = count;
            countdownOverlay.classList.remove('hidden');
            
            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownOverlay.textContent = count;
                } else {
                    clearInterval(countdownInterval);
                    countdownOverlay.classList.add('hidden');
                    resetGame();
                    gameLoop();
                }
            }, 1000);
        }

        // --- Game Logic ---
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const timeDisplay = document.getElementById('time-display');
        const catchesDisplay = document.getElementById('catches-display');
        const gameOverMessage = document.getElementById('game-over-message');
        const restartGameBtn = document.getElementById('restart-game-btn');

        const initialCanvasWidth = 600;
        const initialCanvasHeight = 400;
        let currentCanvasWidth = initialCanvasWidth;
        let currentCanvasHeight = initialCanvasHeight;

        let isGameOver = false;
        let startTime = 0;
        let animationFrameId;
        
        let catches = 0;
        
        // Offset for centered boundary
        let offsetX = 0;
        let offsetY = 0;

        const frisbee = {
            x: initialCanvasWidth / 2,
            y: initialCanvasHeight / 2,
            radius: 15,
            baseSpeed: 3,
            speedMultiplier: 1,
            dx: 3,
            dy: 3,
            color: '#0ff'
        };

        const player = {
            x: initialCanvasWidth / 2 - 25,
            y: 0,
            width: 50,
            height: 10,
            color: '#ff0'
        };
        
        const playerSpeed = 10;
        let isMovingLeft = false;
        let isMovingRight = false;


        function drawFrisbee() {
            ctx.beginPath();
            ctx.arc(frisbee.x, frisbee.y, frisbee.radius, 0, Math.PI * 2);
            ctx.fillStyle = frisbee.color;
            ctx.shadowColor = frisbee.color;
            ctx.shadowBlur = 15;
            ctx.fill();
            ctx.closePath();
        }

        function drawPlayer() {
            ctx.beginPath();
            // Draw the player relative to the centered boundary height
            player.y = offsetY + currentCanvasHeight - player.height - 10;
            ctx.rect(player.x, player.y, player.width, player.height);
            ctx.fillStyle = player.color;
            ctx.shadowColor = player.color;
            ctx.shadowBlur = 15;
            ctx.fill();
            ctx.closePath();
        }

        // Draws the glowing, shrinking boundary
        function drawBounds() {
            ctx.beginPath();
            ctx.strokeStyle = '#0ff';
            ctx.lineWidth = 2;
            ctx.shadowColor = '#0ff';
            ctx.shadowBlur = 20;
            // Draw the boundary from the new offset
            ctx.strokeRect(offsetX, offsetY, currentCanvasWidth, currentCanvasHeight);
            ctx.closePath();
        }

        function update() {
            // Update frisbee position
            frisbee.x += frisbee.dx * frisbee.speedMultiplier;
            frisbee.y += frisbee.dy * frisbee.speedMultiplier;

            // Wall collision detection using new centered boundary coordinates
            if (frisbee.x + frisbee.radius > offsetX + currentCanvasWidth || frisbee.x - frisbee.radius < offsetX) {
                frisbee.dx = -frisbee.dx;
            }
            if (frisbee.y - frisbee.radius < offsetY) {
                frisbee.dy = -frisbee.dy;
            }

            // Player movement
            if (isMovingLeft) {
                player.x -= playerSpeed;
            }
            if (isMovingRight) {
                player.x += playerSpeed;
            }
            // Clamp player position to stay within the new centered boundary
            player.x = Math.max(Math.min(player.x, offsetX + currentCanvasWidth - player.width), offsetX);

            // Player collision detection
            if (frisbee.x > player.x && frisbee.x < player.x + player.width &&
                frisbee.y + frisbee.radius > player.y && frisbee.y - frisbee.radius < player.y + player.height) {
                
                // Reverse the direction of the frisbee
                frisbee.dy = -frisbee.dy;
                
                // Increase the speed with each catch
                frisbee.speedMultiplier += 0.25;

                // Increment score
                catches++;
                catchesDisplay.textContent = catches;
            }
            
            // Game over condition: frisbee falls past the player
            if (frisbee.y + frisbee.radius > offsetY + currentCanvasHeight) {
                isGameOver = true;
            }

            // Update time
            const elapsedTime = (Date.now() - startTime) / 1000;
            timeDisplay.textContent = elapsedTime.toFixed(2);
        }

        function gameLoop() {
            if (isGameOver) {
                cancelAnimationFrame(animationFrameId);
                gameOverMessage.classList.remove('hidden');
                restartGameBtn.classList.remove('hidden');
                return;
            }
            
            ctx.clearRect(0, 0, initialCanvasWidth, initialCanvasHeight); // Clear the full original canvas
            
            ctx.save(); // Save the current state of the canvas
            ctx.beginPath();
            ctx.rect(offsetX, offsetY, currentCanvasWidth, currentCanvasHeight);
            ctx.clip(); // Clip the drawing area to the new, smaller size
            
            drawBounds(); // Draw the new boundary
            update();
            drawFrisbee();
            drawPlayer();

            ctx.restore(); // Restore the canvas state
            animationFrameId = requestAnimationFrame(gameLoop);
        }

        function resetGame() {
            isGameOver = false;
            startTime = Date.now();
            currentCanvasWidth = initialCanvasWidth;
            currentCanvasHeight = initialCanvasHeight;
            canvas.width = initialCanvasWidth;
            canvas.height = initialCanvasHeight;
            
            catches = 0;
            catchesDisplay.textContent = catches;

            // Reset offsets
            offsetX = 0;
            offsetY = 0;

            // Start frisbee in the upper right-hand corner
            frisbee.x = initialCanvasWidth - frisbee.radius;
            frisbee.y = frisbee.radius;
            frisbee.dx = -3; // Move left
            frisbee.dy = 3;  // Move down
            frisbee.speedMultiplier = 1;

            player.x = initialCanvasWidth / 2 - player.width / 2;
            
            gameOverMessage.classList.add('hidden');
            restartGameBtn.classList.add('hidden');
            timeDisplay.textContent = '0.00';
        }

        function shrinkCanvas() {
            if (isGameOver) return;
            const shrinkRate = 20; // Pixels to shrink per side
            
            currentCanvasWidth = Math.max(currentCanvasWidth - shrinkRate, 200);
            currentCanvasHeight = Math.max(currentCanvasHeight - shrinkRate, 150);

            // Update offsets to keep the drawing area centered
            offsetX = (initialCanvasWidth - currentCanvasWidth) / 2;
            offsetY = (initialCanvasHeight - currentCanvasHeight) / 2;

            // Re-center player and frisbee
            player.x = Math.max(Math.min(player.x, offsetX + currentCanvasWidth - player.width), offsetX);
            frisbee.x = Math.max(Math.min(frisbee.x, offsetX + currentCanvasWidth - frisbee.radius), offsetX + frisbee.radius);
            frisbee.y = Math.max(Math.min(frisbee.y, offsetY + currentCanvasHeight - frisbee.radius), offsetY + frisbee.radius);
        }

        // Mouse and touch controls
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            player.x = mouseX - player.width / 2;
        });
        
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault(); // Prevent scrolling
            const rect = canvas.getBoundingClientRect();
            const touchX = e.touches[0].clientX - rect.left;
            player.x = touchX - player.width / 2;
        }, { passive: false });
        
        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                isMovingLeft = true;
            } else if (e.key === 'ArrowRight') {
                isMovingRight = true;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowLeft') {
                isMovingLeft = false;
            } else if (e.key === 'ArrowRight') {
                isMovingRight = false;
            }
        });

        // Shrink canvas every 10 seconds
        setInterval(shrinkCanvas, 10000);

        restartGameBtn.addEventListener('click', () => {
             quizContainer.style.display = 'block';
             gameContainer.style.display = 'none';
             renderQuiz();
        });
        
        // Render quiz on initial page load
        window.onload = renderQuiz;
    </script>
</body>

</html>
